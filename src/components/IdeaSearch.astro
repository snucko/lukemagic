---
// Simple search interface for ideas
---
<div class="max-w-2xl mx-auto mb-8">
  <div class="relative">
    <input
      type="text"
      id="idea-search"
      placeholder="Search magic ideas..."
      class="w-full px-4 py-3 rounded-lg bg-neutral-900 border border-neutral-800 text-white placeholder:text-neutral-500 focus:outline-none focus:border-magic-purple"
    />
  </div>
  <div id="search-results" class="mt-6 grid md:grid-cols-2 gap-4"></div>
</div>

<script>
  async function initSearch() {
    const searchInput = document.getElementById('idea-search');
    const resultsContainer = document.getElementById('search-results');
    
    // Load search index
    const response = await fetch('/search.json');
    const searchIndex = await response.json();
    
    // Simple client-side search
    searchInput.addEventListener('input', (e) => {
      const query = e.target.value.toLowerCase();
      
      if (!query) {
        resultsContainer.innerHTML = '';
        return;
      }
      
      // Search through the index
      const results = [];
      for (const docId in searchIndex.documentStore) {
        const doc = searchIndex.documentStore[docId];
        if (
          doc.title.toLowerCase().includes(query) ||
          doc.summary.toLowerCase().includes(query)
        ) {
          results.push(doc);
        }
      }
      
      // Display results
      if (results.length === 0) {
        resultsContainer.innerHTML = '<p class="col-span-2 text-center text-neutral-500">No ideas found.</p>';
        return;
      }
      
      resultsContainer.innerHTML = results
        .slice(0, 6)
        .map(result => `
          <div class="card p-4">
            <h3 class="font-bold text-lg">${highlightQuery(result.title, query)}</h3>
            <p class="text-sm opacity-80 mt-2">${highlightQuery(result.summary, query)}</p>
            <p class="text-xs text-magic-purple mt-3 font-semibold">${result.tags?.join(', ') || 'Magic'}</p>
          </div>
        `)
        .join('');
    });
  }
  
  function highlightQuery(text, query) {
    const regex = new RegExp(`(${query})`, 'gi');
    return text.replace(regex, '<mark style="background: rgba(var(--magic-purple-rgb), 0.3);">$1</mark>');
  }
  
  initSearch();
</script>

<style>
  mark {
    background: rgba(139, 92, 246, 0.3);
    color: inherit;
    border-radius: 2px;
  }
</style>
